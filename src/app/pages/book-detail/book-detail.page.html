<app-header title="Detalle" [showBackButton]="true"></app-header>

<ion-content>
  @if (loading) {
  <div class="book-detail__spinner">
    <ion-spinner name="crescent" />
  </div>
  } @if (!loading && error) {
  <app-empty-state type="error" message="No se pudo cargar el libro." />
  } @if (!loading && book) {
  <div class="book-detail__cover">
    @if (coverUrl && !imageError) { @if (!imageLoaded) {
    <ion-skeleton-text animated class="book-detail__skeleton" />
    }
    <img
      [src]="coverUrl"
      [alt]="book.title"
      class="book-detail__img"
      [class.book-detail__img--hidden]="!imageLoaded"
      (load)="onImageLoad()"
      (error)="onImageError()"
    />
    } @else {
    <div class="book-detail__placeholder">Sin portada</div>
    }
  </div>

  <div class="book-detail__body">
    <h1 class="book-detail__title">{{ book.title }}</h1>
    <p class="book-detail__authors">{{ authorsLabel }}</p>

    @if (book.first_publish_year) {
    <p class="book-detail__year">{{ book.first_publish_year }}</p>
    }

    <p class="book-detail__description">
      {{ book.description ?? 'Sin descripci√≥n disponible.' }}
    </p>

    @if (!fromList) {
    <ion-button expand="block" (click)="addToList()">
      <ion-icon slot="start" name="bookmark-outline" />
      Agregar a lista
    </ion-button>
    }
  </div>
  }
</ion-content>
